/*
  Tankoban+ Noir Theme Layer (EXPERIMENT)
  - Purely visual layer: overrides styles.css via later load order (Noir / minimal glow)
  - No DOM/ID changes required (safe with existing JS bindings)
*/

:root{
  /* Core palette */
  --vx-bg0: #050505;
  --vx-bg1: #0a0a0a;
  --vx-ink: rgba(245,245,245,.92);
  --vx-muted: rgba(245,245,245,.60);

  --vx-glass: rgba(0,0,0,.42);
  --vx-glass2: rgba(0,0,0,.58);
  --vx-border: rgba(255,255,255,.10);
  --vx-border2: rgba(255,255,255,.16);

  --vx-accent: #c7a76b;       /* muted gold */
  --vx-accent-rgb: 199,167,107;
  --vx-accent2: #9ca3af;      /* smoke */
  --vx-accent2-rgb: 156,163,175;
  --vx-hot: #d97706;          /* amber */

  --vx-shadow: rgba(0,0,0,.55);
  --vx-shadow2: rgba(0,0,0,.35);

  --vx-radius: 12px;
  --vx-radius-sm: 10px;
  --vx-radius-lg: 18px;
  --vx-blur: 10px;

  /* Map existing tokens -> new vibe */
  --bg: var(--vx-bg0);
  --bg-rgb: 5,6,10;
  --panel: rgba(255,255,255,.06);
  --panel2: rgba(255,255,255,.08);
  --text: var(--vx-ink);
  --muted: var(--vx-muted);
  --border: var(--vx-border);
  --accent: var(--vx-accent);
  --accent-rgb: var(--vx-accent-rgb);

  /* Library sizing polish */
  --lib-topbar-h: 46px;
  --lib-side-w: 252px;
  --lib-gap: 12px;
  --lib-pad: 12px;
  --lib-radius: 14px;
  --lib-radius-sm: 12px;
  --lib-border: rgba(255,255,255,.12);
  --lib-hover: rgba(255,255,255,.08);
  --lib-select: rgba(var(--vx-accent-rgb),.18);

  /* Topbar tokens (baseline uses these) */
  --topbar-bg: transparent;
  --topbar-bg2: transparent;
  --topbar-text: var(--vx-ink);
  --topbar-muted: var(--vx-muted);
  --topbar-border: rgba(255,255,255,.08);
  --topbar-border2: rgba(255,255,255,.10);
  --topbar-shadow: rgba(0,0,0,.55);
}

/* Baseline has a library-only token scope; override it back to the new global palette. */
body:not(.inPlayer){
  --bg: var(--vx-bg0);
  --bg-rgb: 5,6,10;
  --text: var(--vx-ink);
  --muted: var(--vx-muted);
  --accent: var(--vx-accent);
  --accent-rgb: var(--vx-accent-rgb);
  --surface-rgb: 10,12,20;

  --topbar-bg: transparent;
  --topbar-bg2: transparent;
  --topbar-text: var(--vx-ink);
  --topbar-muted: var(--vx-muted);
  --topbar-border: rgba(255,255,255,.08);
  --topbar-border2: rgba(255,255,255,.10);
  --topbar-shadow: rgba(0,0,0,.55);
}

/* App background (animated, subtle, GPU-friendly) */
.bgFx{
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  background:
    radial-gradient(1200px 800px at 15% 10%, rgba(var(--vx-accent2-rgb), .22), transparent 60%),
    radial-gradient(900px 700px at 85% 20%, rgba(var(--vx-accent-rgb), .18), transparent 55%),
    radial-gradient(1100px 900px at 50% 85%, rgba(251,113,133,.12), transparent 60%),
    linear-gradient(180deg, var(--vx-bg0) 0%, var(--vx-bg1) 100%);
  filter: saturate(120%);
  transform: translateZ(0);
  animation: vxBgDrift 18s ease-in-out infinite alternate;
}

/* Add a very light "film grain" using gradients (no external assets). */
.bgFx::after{
  content: "";
  position: absolute;
  inset: 0;
  background:
    repeating-linear-gradient(
      0deg,
      rgba(255,255,255,.018),
      rgba(255,255,255,.018) 1px,
      rgba(0,0,0,0) 2px,
      rgba(0,0,0,0) 4px
    );
  opacity: .35;
  mix-blend-mode: overlay;
}

@keyframes vxBgDrift{
  0%{ transform: scale(1) translate3d(0,0,0); filter: saturate(118%) hue-rotate(0deg); }
  100%{ transform: scale(1.03) translate3d(0,-10px,0); filter: saturate(130%) hue-rotate(6deg); }
}

@media (prefers-reduced-motion: reduce){
  .bgFx{ animation: none; }
  *{ scroll-behavior: auto !important; }
}

/* Keep app chrome above background */
#app{ position: relative; z-index: 1; min-height: 100vh; }

/* Typography + selection */
body{
  background: var(--vx-bg0);
  color: var(--vx-ink);
  letter-spacing: .1px;
}
::selection{ background: rgba(var(--vx-accent-rgb), .22); }

/* Modern focus ring */
:where(button, input, select, textarea, [role="slider"], [tabindex]):focus-visible{
  outline: 2px solid rgba(var(--vx-accent-rgb), .55);
  outline-offset: 2px;
}

/* Smooth interactions */
:where(.btn, .iconBtn, .navBtn, .chip, .scrubActionBtn, .hudBtn, .hudBtnWide){
  transition:
    background-color .16s ease,
    border-color .16s ease,
    box-shadow .16s ease,
    transform .10s ease,
    filter .16s ease;
}

/* -----------------
   TOPBAR / LIBRARY
------------------*/

.topbar{
  position: fixed;
  top: 0; left: 0; right: 0;
  height: var(--lib-topbar-h);
  padding: 6px 12px;
  background: rgba(10,12,20,.52) !important;
  backdrop-filter: blur(var(--vx-blur)) saturate(145%);
  -webkit-backdrop-filter: blur(var(--vx-blur)) saturate(145%);
  border-bottom: 1px solid rgba(255,255,255,.10) !important;
  box-shadow: 0 14px 40px -22px rgba(0,0,0,.85), 0 1px 0 rgba(255,255,255,.06) inset;
}

.tbTitle{
  font-weight: 850;
  letter-spacing: .2px;
  font-size: 14px;
  color: var(--text) !important;
  text-shadow: none;
}

.modeSwitch{
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(255,255,255,.10);
  border-radius: 999px;
  padding: 2px;
  display:flex;
  gap: 2px;
  pointer-events: auto;
}

.modeBtn{
  border-radius: 999px;
  border: 1px solid transparent;
  background: transparent;
  color: rgba(255,255,255,.78);
  padding: 6px 10px;
  font-weight: 850;
}

.modeBtn:hover{ background: rgba(255,255,255,.06); }
.modeBtn.active{
  background: linear-gradient(135deg, rgba(var(--vx-accent2-rgb), .30), rgba(var(--vx-accent-rgb), .22));
  border-color: rgba(var(--vx-accent-rgb), .30);
  color: rgba(255,255,255,.94);
  box-shadow: 0 10px 26px -18px rgba(var(--vx-accent-rgb), .55);
}

/* Buttons */
.iconBtn,
.topbar .iconBtn{
  width: 30px;
  height: 30px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,.12) !important;
  background: rgba(255,255,255,.06) !important;
  color: rgba(255,255,255,.92) !important;
  box-shadow: 0 10px 22px -18px rgba(0,0,0,.85);
}
.iconBtn:hover{ background: rgba(255,255,255,.10) !important; box-shadow: 0 12px 26px -18px rgba(0,0,0,.85), 0 0 0 1px rgba(var(--vx-accent-rgb),.08) inset; }
.iconBtn:active{ transform: translateY(1px) scale(.98); }

.btn{
  border-radius: 999px;
  border: 1px solid rgba(var(--vx-accent-rgb), .35) !important;
  background: linear-gradient(135deg, rgba(var(--vx-accent2-rgb), .18), rgba(var(--vx-accent-rgb), .12)) !important;
  box-shadow: 0 12px 30px -22px rgba(var(--vx-accent-rgb), .45);
}

.btn:hover{ box-shadow: 0 14px 34px -22px rgba(var(--vx-accent-rgb), .55); }

.btn-ghost,
.topbar .btn-ghost{
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.14) !important;
  background: rgba(255,255,255,.06) !important;
}
.btn-ghost:hover{ background: rgba(255,255,255,.10) !important; }

/* Inputs / selects */
.search,
.select,
.settingsTextArea{
  border-radius: 12px !important;
  border: 1px solid rgba(255,255,255,.12) !important;
  background: rgba(255,255,255,.05) !important;
  color: rgba(255,255,255,.92) !important;
  box-shadow: 0 10px 24px -20px rgba(0,0,0,.9);
}
.search::placeholder{ color: rgba(255,255,255,.40) !important; }

/* Library shell */
.libSidebar{
  background: rgba(10,12,20,.46) !important;
  backdrop-filter: blur(calc(var(--vx-blur) - 3px)) saturate(145%);
  -webkit-backdrop-filter: blur(calc(var(--vx-blur) - 3px)) saturate(145%);
  border-right: 1px solid rgba(255,255,255,.10) !important;
}

/* Build 7 (UI): Remove fixed sidebar layout; reuse sidebar content as an off-canvas drawer. */
body:not(.inPlayer) .libraryShell{
  grid-template-columns: 1fr !important;
}

body:not(.inPlayer) .libSidebar{
  position: fixed;
  top: var(--lib-topbar-h);
  left: 0;
  bottom: 0;
  width: min(320px, 92vw);
  transform: translateX(-106%);
  transition: transform .18s ease;
  z-index: 80;
  border-right: 1px solid rgba(255,255,255,.12) !important;
  box-shadow: 0 22px 60px -38px rgba(0,0,0,.95);
}

/* FIX-DRAWER: scope to active view only — prevents other-mode sidebar flash */
body:not(.inPlayer).libDrawerOpen .view:not(.hidden) > .libraryShell > .libSidebar{
  transform: translateX(0);
}

.drawerBackdrop{
  position: fixed;
  top: var(--lib-topbar-h);
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,.42);
  opacity: 0;
  pointer-events: none;
  transition: opacity .16s ease;
  z-index: 70;
}

body:not(.inPlayer).libDrawerOpen .drawerBackdrop{
  opacity: 1;
  pointer-events: auto;
}

.navHeader{
  color: rgba(255,255,255,.86) !important;
  font-size: 12px;
  letter-spacing: .35px;
  text-transform: uppercase;
}

.navBtn{
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,.12) !important;
  background: rgba(255,255,255,.05) !important;
}
.navBtn:hover{ background: rgba(255,255,255,.09) !important; box-shadow: 0 12px 26px -22px rgba(0,0,0,.85); }

/* Panels and cards */
.panel{
  border-radius: var(--vx-radius) !important;
  background: rgba(255,255,255,.06) !important;
  border: 1px solid rgba(255,255,255,.12) !important;
  box-shadow: 0 18px 48px -34px rgba(0,0,0,.92);
}

.panelTitle{
  font-weight: 950;
  letter-spacing: .2px;
}

/* Tighten content area – push Continue shelf flush to topbar */
.libContent{ padding-top: 0 !important; }

/* Continue shelf */
.continuePanel{
  height: auto !important;
  padding: 0 12px 10px !important;
}

.continueHead{ margin: 0 10px 10px !important; }

/* Build 10 (UI): Comics Continue Reading thumbnails match the larger tile sizing. */
#continueRow.continueYacRow{
  align-items: flex-start !important;
}
#continueRow .contTile{
  width: 200px !important;
  height: auto !important;
}
#continueRow .contCover{
  height: 308px !important;
  flex: 0 0 auto !important;
}
body[data-tile-density="compact"] #continueRow .contTile{
  width: 170px !important;
}
body[data-tile-density="compact"] #continueRow .contCover{
  height: 262px !important;
}


/* Search dropdown */
.searchResults{
  background: rgba(10,12,20,.86) !important;
  backdrop-filter: blur(var(--vx-blur)) saturate(160%);
  -webkit-backdrop-filter: blur(var(--vx-blur)) saturate(160%);
  border: 1px solid rgba(255,255,255,.12) !important;
  box-shadow: 0 26px 70px -40px rgba(0,0,0,.92);
}
.resItem:hover{ background: rgba(var(--vx-accent-rgb), .10) !important; }
.resType{ border-radius: 10px !important; }

/* Series cards */
/* Build 8 (UI): Larger thumbnails + density toggle (Large/Medium). */
:root{
  --tile-min: 200px;
  --tile-gap: 16px;
  --tile-title-size: 13px;
  --tile-meta-size: 12px;
}
body[data-tile-density="compact"]{
  --tile-min: 170px;
  --tile-gap: 12px;
  --tile-title-size: 12px;
  --tile-meta-size: 11px;
}

/* Build 9 (UI): Comics grid returns to original thumbnail size.
   Keep all other Comic UI frozen; only restore tile sizing.
   Original (pre Build 8) values:
     - grid min tile: 132px
     - gap: 8px
     - title/meta sizing: 12px/11px
   We set these as scoped CSS variables so the Build 8 grid rule can remain
   in place without affecting Comics.
*/
#libraryView{
  /* Build 10 (UI): Comics tile sizing matches Videos (bigger covers). */
  --tile-min: 200px;
  --tile-gap: 16px;
  --tile-title-size: 13px;
  --tile-meta-size: 12px;
}
body[data-tile-density="compact"] #libraryView{
  --tile-min: 170px;
  --tile-gap: 12px;
  --tile-title-size: 12px;
  --tile-meta-size: 11px;
}

.seriesGrid{
  grid-template-columns: repeat(auto-fill, minmax(var(--tile-min), 1fr)) !important;
  gap: var(--tile-gap) !important;
}
.seriesCard{
  border-radius: var(--vx-radius) !important;
  border: 1px solid rgba(255,255,255,.12) !important;
  background: rgba(255,255,255,.04) !important;
  box-shadow: 0 18px 52px -38px rgba(0,0,0,.92);
  overflow: hidden;
}
.seriesCard:hover{
  transform: translateY(-2px);
  box-shadow: 0 26px 72px -48px rgba(0,0,0,.96), 0 0 0 1px rgba(var(--vx-accent-rgb), .10) inset;
}

.seriesCard .seriesCoverWrap{
  border-radius: 14px !important;
}

/* Typography scaling for larger tiles */
.seriesName{ font-size: var(--tile-title-size) !important; margin-top: 10px !important; }
.seriesMeta{ font-size: var(--tile-meta-size) !important; }

/* Volumes table */
.volTableWrap{
  border-radius: var(--vx-radius) !important;
  border: 1px solid rgba(255,255,255,.12) !important;
  overflow: hidden;
  background: rgba(255,255,255,.04) !important;
}

.volTableHead{
  background: rgba(10,12,20,.72) !important;
  backdrop-filter: blur(calc(var(--vx-blur) - 2px));
  -webkit-backdrop-filter: blur(calc(var(--vx-blur) - 2px));
  border-bottom: 1px solid rgba(255,255,255,.10) !important;
}

.volRow:hover{ background: rgba(255,255,255,.05) !important; }
.volRow.active,
.volRow.selected{
  background: rgba(var(--vx-accent-rgb), .10) !important;
  box-shadow: 0 0 0 1px rgba(var(--vx-accent-rgb), .18) inset;
}

/* -----------------
   OVERLAYS / MODALS
------------------*/

.settingsOverlay,
.keysOverlay,
.videoPrompt{
  background: rgba(0,0,0,.55) !important;
  backdrop-filter: blur(calc(var(--vx-blur) + 2px)) saturate(130%);
  -webkit-backdrop-filter: blur(calc(var(--vx-blur) + 2px)) saturate(130%);
}

.settingsCard,
.keysCard,
.endCard,
.videoTracksCard,
.loadingCard{
  border-radius: var(--vx-radius-lg) !important;
  border: 1px solid rgba(255,255,255,.12) !important;
  background: rgba(10,12,20,.78) !important;
  box-shadow: 0 36px 90px -62px rgba(0,0,0,.98);
}

.settingsTitle,
.keysTitle,
.endTitle,
.videoTracksTitle,
.loadingTitle{
  font-weight: 950 !important;
  letter-spacing: .2px;
}

.chip,
.primaryBtn{
  border-radius: 999px !important;
}

.primaryBtn{
  border: 1px solid rgba(var(--vx-accent-rgb), .40) !important;
  background: linear-gradient(135deg, rgba(var(--vx-accent2-rgb), .34), rgba(var(--vx-accent-rgb), .26)) !important;
  box-shadow: 0 18px 48px -34px rgba(var(--vx-accent-rgb), .55);
}

/* Toast */
.toast{
  background: rgba(10,12,20,.78) !important;
  border: 1px solid rgba(255,255,255,.14) !important;
  border-radius: 999px !important;
  backdrop-filter: blur(var(--vx-blur)) saturate(140%);
  -webkit-backdrop-filter: blur(var(--vx-blur)) saturate(140%);
  box-shadow: 0 22px 70px -52px rgba(0,0,0,.98);
}

/* -----------------
   READER (CANVAS)
------------------*/

body.inPlayer{
  background: var(--vx-bg0);
}

.playerBar{
  background: rgba(10,12,20,.44) !important;
  backdrop-filter: blur(var(--vx-blur)) saturate(140%);
  -webkit-backdrop-filter: blur(var(--vx-blur)) saturate(140%);
  border-bottom: 1px solid rgba(255,255,255,.10) !important;
}

.playerFooter{
  background: rgba(10,12,20,.46) !important;
  backdrop-filter: blur(var(--vx-blur)) saturate(140%);
  -webkit-backdrop-filter: blur(var(--vx-blur)) saturate(140%);
  border-top: 1px solid rgba(255,255,255,.10) !important;
}

.cornerPrefsBtn{
  border-radius: 999px !important;
  border: 1px solid rgba(255,255,255,.14) !important;
  background: rgba(255,255,255,.06) !important;
  box-shadow: 0 20px 50px -40px rgba(0,0,0,.95);
}

.cornerPrefsBtn:hover{
  background: rgba(255,255,255,.10) !important;
  box-shadow: 0 26px 70px -52px rgba(0,0,0,.98), 0 0 0 1px rgba(var(--vx-accent-rgb), .10) inset;
}

/* Canvas "halo" without touching the canvas itself */
.stageWrap::before{
  content: "";
  position: absolute;
  inset: 8px;
  pointer-events: none;
  border-radius: 22px;
  box-shadow:
    0 0 0 1px rgba(255,255,255,.05) inset,
    0 30px 90px -60px rgba(0,0,0,.92);
  opacity: .55;
}

/* Scrub bar */
.scrubTrack{ opacity: .85; }
.scrubFill{ filter: none; }
.scrubThumb{ box-shadow: 0 10px 26px -16px rgba(0,0,0,.95); }

.scrubActionBtn{
  border-radius: 12px !important;
  border: 1px solid rgba(255,255,255,.12) !important;
  background: rgba(255,255,255,.06) !important;
}
.scrubActionBtn:hover{ background: rgba(255,255,255,.10) !important; }

/* -----------------
   VIDEO PLAYER
------------------*/

.videoPlayerBar{
  background: rgba(10,12,20,.44) !important;
  border-bottom: 1px solid rgba(255,255,255,.10) !important;
  backdrop-filter: blur(var(--vx-blur)) saturate(140%);
  -webkit-backdrop-filter: blur(var(--vx-blur)) saturate(140%);
}

.videoHud{
  background: rgba(10,12,20,.34) !important;
  border: 1px solid rgba(255,255,255,.10) !important;
  border-radius: var(--vx-radius-lg) !important;
  backdrop-filter: blur(var(--vx-blur)) saturate(140%);
  -webkit-backdrop-filter: blur(var(--vx-blur)) saturate(140%);
  box-shadow: 0 34px 86px -62px rgba(0,0,0,.98);
}

.hudBtn,
.hudBtnWide,
.chipBtn{
  border-radius: 999px !important;
  border: 1px solid rgba(255,255,255,.12) !important;
  background: rgba(255,255,255,.06) !important;
}

.hudBtn:hover,
.hudBtnWide:hover,
.chipBtn:hover{ background: rgba(255,255,255,.10) !important; }

.videoCenterFlash{
  border-radius: 999px !important;
  filter: none;
}

/* Scrollbar polish */
*::-webkit-scrollbar{ width: 12px; height: 12px; }
*::-webkit-scrollbar-track{ background: rgba(255,255,255,.04); }
*::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,.10);
  border: 3px solid rgba(0,0,0,0);
  background-clip: padding-box;
  border-radius: 999px;
}
*::-webkit-scrollbar-thumb:hover{ background: rgba(255,255,255,.14); background-clip: padding-box; }



/* =========================================================
   Typography + spacing pass (EXPERIMENT)
   Goal: consistent text hierarchy + cleaner rhythm everywhere
   ========================================================= */

:root{
  /* Type system */
  --tx-font-sans: "Inter", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
  --tx-font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

  --tx-size-xxs: 10px;
  --tx-size-xs: 11px;
  --tx-size-sm: 12px;
  --tx-size-md: 13px;
  --tx-size-lg: 14px;
  --tx-size-xl: 16px;
  --tx-size-2xl: 18px;

  --tx-lh-tight: 1.12;
  --tx-lh-snug: 1.25;
  --tx-lh-normal: 1.35;
  --tx-lh-relaxed: 1.50;

  --tx-track-tight: -0.012em;
  --tx-track-normal: 0.002em;
  --tx-track-wide: 0.08em;

  --tx-w-title: 900;
  --tx-w-head: 850;
  --tx-w-ui: 700;
  --tx-w-body: 520;
}

/* Global defaults */
body{
  font-family: var(--tx-font-sans) !important;
  font-size: var(--tx-size-md) !important;
  line-height: var(--tx-lh-normal) !important;
  letter-spacing: var(--tx-track-normal);
  font-weight: var(--tx-w-body);
}

code, pre, .mono{
  font-family: var(--tx-font-mono) !important;
  font-feature-settings: "ss01" 1, "ss02" 1, "tnum" 1;
}

.muted{ color: rgba(255,255,255,.60) !important; }
.tiny{ font-size: var(--tx-size-sm) !important; line-height: var(--tx-lh-normal) !important; }
.small{ font-size: var(--tx-size-xs) !important; line-height: var(--tx-lh-normal) !important; }

/* Top bar hierarchy */
.tbTitle{
  font-weight: 850;
  letter-spacing: .2px;
  font-size: 14px;
  color: var(--text) !important;
  text-shadow: none;
}

/* Section headers: consistent “label” style */
.panelTitle,
.navHeader,
.resHead,
.volTableHead .cell{
  text-transform: uppercase;
  letter-spacing: var(--tx-track-wide) !important;
}

.panelTitle{
  margin: 0 !important; /* margin is owned by the row */
  font-size: var(--tx-size-sm) !important;
  font-weight: var(--tx-w-head) !important;
  line-height: var(--tx-lh-tight) !important;
  color: rgba(255,255,255,.84) !important;
}

.panelTitleRow{
  margin-bottom: 12px !important;
  align-items: baseline !important;
}

.navHeader{
  font-size: var(--tx-size-xs) !important;
  font-weight: var(--tx-w-head) !important;
  color: rgba(255,255,255,.74) !important;
  margin-bottom: 8px !important;
}

/* Primary panel titles */
.continueTitle,
.settingsTitle,
.keysTitle{
  font-weight: var(--tx-w-title) !important;
  letter-spacing: var(--tx-track-tight) !important;
  line-height: var(--tx-lh-tight) !important;
}

.continueTitle{
  font-size: 17px !important;
}

/* Buttons: consistent weight + spacing */
.btn,
.btn-ghost,
.navBtn,
.iconBtn,
.modeBtn,
.scanPill,
.scanPillBtn,
.hudBtn,
.hudBtnWide,
.chipBtn{
  font-family: var(--tx-font-sans) !important;
  font-weight: var(--tx-w-ui) !important;
  letter-spacing: 0.005em;
}

.btn{ padding: 10px 13px !important; }
.btn-sm{ font-size: var(--tx-size-xs) !important; padding: 7px 10px !important; }
.navBtn{ font-size: var(--tx-size-sm) !important; padding: 8px 10px !important; }
.iconBtn{ font-size: var(--tx-size-sm) !important; }

.modeBtn{
  font-size: var(--tx-size-sm) !important;
  padding: 7px 12px !important;
}

/* Sidebar tree items */
.folderItem{
  font-size: var(--tx-size-sm) !important;
  line-height: var(--tx-lh-snug) !important;
  font-weight: 650 !important;
  letter-spacing: 0.003em;
  padding: 6px 8px !important;
}

/* Series cards: readable, consistent */
.seriesTitle{
  font-size: var(--tx-size-sm) !important;
  line-height: var(--tx-lh-snug) !important;
  font-weight: 750 !important;
  letter-spacing: 0.003em;
}

.seriesMeta{
  font-size: var(--tx-size-xs) !important;
  line-height: var(--tx-lh-normal) !important;
  color: rgba(255,255,255,.58) !important;
}

/* Search results */
.resMain{
  font-size: var(--tx-size-sm) !important;
  font-weight: var(--tx-w-title) !important;
  letter-spacing: var(--tx-track-tight) !important;
}

.resSub{
  font-size: var(--tx-size-xs) !important;
  line-height: var(--tx-lh-normal) !important;
  color: rgba(255,255,255,.58) !important;
}

/* Continue panel rhythm (remove odd margins; let padding do the work) */
.continuePanel{
  padding: 14px !important;
}
.continueHead{
  margin: 0 !important;
  padding: 0 !important;
  align-items: baseline !important;
}
.contTools{
  gap: 10px !important;
}

/* Tables: denser but more “product” looking */
.volTableHead{
  padding: 8px 12px !important;
}
.volTableHead .cell{
  font-size: var(--tx-size-xxs) !important;
  font-weight: var(--tx-w-head) !important;
  color: rgba(255,255,255,.70) !important;
}

.volTrow{
  padding: 6px 12px !important;
  font-size: var(--tx-size-sm) !important;
  line-height: var(--tx-lh-snug) !important;
}

.volTrow .cell{
  color: rgba(255,255,255,.84);
}

.cell.num,
.cell.pages,
.cell.size,
.cell.read{
  font-variant-numeric: tabular-nums;
  font-feature-settings: "tnum" 1;
}

/* File name column: subtle mono look for scanability */
.cell.file,
.volTrow .cell.file{
  font-family: var(--tx-font-mono) !important;
  font-size: var(--tx-size-xs) !important;
  color: rgba(255,255,255,.68) !important;
}

/* Preview info chips and microcopy */
.volPreviewInfo,
.volPreviewInfo.muted,
.volPreviewInfo.tiny{
  font-size: var(--tx-size-xs) !important;
  letter-spacing: 0.01em;
}

/* Settings layout: tighter label + helper spacing */
.settingsGroup{ gap: 8px !important; }
.settingsLabel{
  font-size: var(--tx-size-sm) !important;
  letter-spacing: 0.003em;
  color: rgba(255,255,255,.84) !important;
}
.settingsTop{ gap: 10px !important; }
.settingsTextArea{
  border-radius: 14px !important; /* text areas feel better with a softer radius */
  line-height: var(--tx-lh-relaxed) !important;
}

/* Badges: consistent capsule typography */
.badge{
  font-size: var(--tx-size-xxs) !important;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  padding: 3px 7px !important;
}

/* Player footer “now playing” text */
.nowTitle{
  font-size: var(--tx-size-lg) !important;
  font-weight: var(--tx-w-title) !important;
  letter-spacing: var(--tx-track-tight) !important;
  line-height: var(--tx-lh-tight) !important;
}
.nowSub{
  font-size: var(--tx-size-sm) !important;
  color: rgba(255,255,255,.58) !important;
}

/* -------------------------------------------------------------------------- */
/* FIX: Video Playlist must scroll inside the max-height hudPanel (child mpv)  */
/* Root cause: #videoPlaylistPanel is a max-height block with overflow:hidden, */
/* but its body/list were not flexed to take remaining height, so content      */
/* got clipped instead of becoming a scrollable region.                        */
/* -------------------------------------------------------------------------- */
#videoPlaylistPanel{
  display: flex !important;
  flex-direction: column !important;
}
#videoPlaylistPanel.hidden{ display: none !important; }
#videoPlaylistPanel .panelHeader{ flex: 0 0 auto !important; }
#videoPlaylistPanel .panelBody{
  flex: 1 1 auto !important;
  min-height: 0 !important;
}
#videoPlaylistPanel .panelRow{ flex: 0 0 auto !important; }
#videoPlaylistList{
  flex: 1 1 auto !important;
  min-height: 0 !important;
  overflow: auto !important;
  overscroll-behavior: contain;
  scrollbar-gutter: stable;
}
/* Tankoban Plus Build 67: Anchored Popovers for Speed and Volume */

/* Base anchored popover styling */
.videoAnchoredPopover {
  position: fixed;
  z-index: 10000;
  background: rgba(28, 28, 32, 0.95);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  padding: 12px;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
  min-width: 140px;
  transition: opacity 0.15s ease, transform 0.15s ease;
}

.videoAnchoredPopover.hidden {
  opacity: 0;
  pointer-events: none;
  transform: translateY(-4px);
}

/* Popover content layouts */
.anchoredPopoverContent {
  display: flex;
  align-items: center;
  gap: 12px;
  justify-content: center;
}

.anchoredPopoverVertical {
  flex-direction: column;
  padding: 16px 8px;
  gap: 16px;
}

/* Popover buttons */
.popoverBtn {
  background: rgba(255, 255, 255, 0.1);
  border: none;
  color: white;
  font-size: 20px;
  font-weight: 600;
  padding: 10px 14px;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  min-width: 40px;
  user-select: none;
  -webkit-user-select: none;
}

.popoverBtn:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: scale(1.05);
}

.popoverBtn:active {
  background: rgba(255, 255, 255, 0.3);
  transform: scale(0.98);
}

.popoverBtn:focus {
  outline: 2px solid rgba(255, 255, 255, 0.4);
  outline-offset: 2px;
}

/* Popover value display */
.popoverValue {
  color: white;
  font-size: 15px;
  font-weight: 600;
  min-width: 56px;
  text-align: center;
  letter-spacing: 0.5px;
}

/* Vertical slider for volume */
.popoverSlider {
  -webkit-appearance: slider-vertical;
  appearance: slider-vertical;
  writing-mode: bt-lr;
  height: 120px;
  width: 6px;
  background: transparent;
  cursor: pointer;
}

/* Webkit slider styling */
.popoverSlider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: white;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
}

.popoverSlider::-webkit-slider-thumb:hover {
  background: #fff;
  transform: scale(1.1);
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
}

.popoverSlider::-webkit-slider-thumb:active {
  transform: scale(0.95);
}

.popoverSlider::-webkit-slider-runnable-track {
  width: 6px;
  height: 100%;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 3px;
  border: none;
}

/* Firefox slider styling */
.popoverSlider::-moz-range-thumb {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: white;
  cursor: pointer;
  border: none;
  transition: all 0.2s ease;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
}

.popoverSlider::-moz-range-thumb:hover {
  background: #fff;
  transform: scale(1.1);
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
}

.popoverSlider::-moz-range-track {
  width: 6px;
  height: 100%;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 3px;
  border: none;
}

/* IE/Edge slider styling */
.popoverSlider::-ms-thumb {
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: white;
  cursor: pointer;
  border: none;
}

.popoverSlider::-ms-track {
  width: 6px;
  height: 100%;
  background: transparent;
  border-color: transparent;
  color: transparent;
}

.popoverSlider::-ms-fill-lower,
.popoverSlider::-ms-fill-upper {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 3px;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .videoAnchoredPopover {
    padding: 10px;
    min-width: 120px;
  }

  .anchoredPopoverContent {
    gap: 10px;
  }

  .popoverBtn {
    font-size: 18px;
    padding: 8px 12px;
    min-width: 36px;
  }

  .popoverValue {
    font-size: 14px;
    min-width: 48px;
  }

  .popoverSlider {
    height: 100px;
  }
}

/* Dark mode enhancements (if theme system exists) */
@media (prefers-color-scheme: dark) {
  .videoAnchoredPopover {
    background: rgba(18, 18, 22, 0.97);
    border-color: rgba(255, 255, 255, 0.08);
  }
}

/* Animation for popover entrance */
@keyframes popoverSlideIn {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.videoAnchoredPopover:not(.hidden) {
  animation: popoverSlideIn 0.2s ease-out;
}

/* Ensure popovers appear above HUD but below fullscreen controls */
.videoAnchoredPopover {
  z-index: 9999;
}

/* Pointer events */
.videoAnchoredPopover {
  pointer-events: auto;
}

.videoAnchoredPopover.hidden {
  pointer-events: none;
}

/* =============================================
   MERIDIAN_FRAME: Frameless window + drag region
   FIX-WIN-CTRL: drag region is now on .topbar itself.
   The overlay element is kept for HTML compatibility but does nothing.
   ============================================= */

/* FIX-WIN-CTRL: make the topbar itself the drag handle */
.topbar{
  -webkit-app-region: drag;
}
/* FIX-WIN-CTRL: overlay kept in HTML but disabled — drag is on .topbar */
.topbarDragRegion{
  display: none;
}
.topbar button,
.topbar input,
.topbar select,
.topbar sl-button,
.topbar sl-input,
.topbar sl-select,
.topbar sl-switch,
.topbar .modeSwitch,
.topbar .winControls,
.topbar .globalSearchWrap{
  -webkit-app-region: no-drag;
}

/* MERIDIAN_FRAME: custom window controls */
.winControls{
  display: flex;
  align-items: center;
  gap: 0;
  margin-left: 6px;
  -webkit-app-region: no-drag;
}

.winCtrl{
  appearance: none;
  -webkit-app-region: no-drag;
  width: 46px;
  height: 30px;
  border: none;
  background: transparent;
  color: rgba(255,255,255,.82);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border-radius: 0;
  padding: 0;
  transition: background .12s ease;
}

.winCtrl:hover{
  background: rgba(255,255,255,.10);
}

.winCtrl:active{
  background: rgba(255,255,255,.20);
}

.winCtrl--close:hover{
  background: #e81123;
  color: #fff;
}

.winCtrl--close:active{
  background: #f1707a;
  color: #fff;
}

/* =============================================
   MERIDIAN_GLASS: Glassmorphic overlays
   ============================================= */

.glass-overlay{
  backdrop-filter: blur(40px) saturate(145%);
  -webkit-backdrop-filter: blur(40px) saturate(145%);
  background: rgba(0,0,0,.55);
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 20px 50px -20px rgba(0,0,0,.75);
}

.keysCard,
.settingsCard,
.webDlPanel,
#contextMenu{
  backdrop-filter: blur(40px) saturate(145%) !important;
  -webkit-backdrop-filter: blur(40px) saturate(145%) !important;
  background: rgba(0,0,0,.55) !important;
  border: 1px solid rgba(255,255,255,.12) !important;
  box-shadow: 0 20px 50px -20px rgba(0,0,0,.75);
}

/* =============================================
   MERIDIAN_CMD: Command palette
   ============================================= */

.cmdPalette{
  position: fixed;
  inset: 0;
  z-index: 200;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: 18vh;
  background: rgba(0,0,0,.45);
}
.cmdPalette.hidden{ display: none !important; }

.cmdPaletteCard{
  width: min(580px, 90vw);
  max-height: 60vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.cmdPaletteInput{
  appearance: none;
  width: 100%;
  padding: 14px 18px;
  font-size: 15px;
  font-family: inherit;
  color: rgba(255,255,255,.92);
  background: transparent;
  border: none;
  border-bottom: 1px solid rgba(255,255,255,.10);
  outline: none;
  box-sizing: border-box;
}
.cmdPaletteInput::placeholder{
  color: rgba(255,255,255,.40);
}

.cmdPaletteResults{
  overflow-y: auto;
  max-height: calc(60vh - 50px);
  scrollbar-width: thin;
  scrollbar-color: rgba(255,255,255,.20) transparent;
}

.cmdPaletteItem{
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 18px;
  cursor: pointer;
  font-size: 13px;
  color: rgba(255,255,255,.82);
  border-bottom: 1px solid rgba(255,255,255,.04);
  transition: background .08s ease;
}
.cmdPaletteItem:hover,
.cmdPaletteItem.active{
  background: rgba(255,255,255,.08);
}

.cmdPaletteType{
  font-size: 10px;
  padding: 2px 6px;
  border-radius: 4px;
  background: rgba(255,255,255,.08);
  color: rgba(255,255,255,.55);
  text-transform: uppercase;
  letter-spacing: .5px;
  flex-shrink: 0;
}

.cmdPaletteLabel{
  flex: 1;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.cmdPaletteHint{
  font-size: 11px;
  color: rgba(255,255,255,.35);
  flex-shrink: 0;
}

.cmdPaletteEmpty{
  padding: 24px 18px;
  text-align: center;
  font-size: 13px;
  color: rgba(255,255,255,.35);
}

/* ===== MERIDIAN_PIN: Sidebar pin/float toggle ===== */

.sidebarPinBtn{
  display: flex;
  align-items: center;
  justify-content: center;
  width: 30px;
  height: 30px;
  border: none;
  border-radius: 8px;
  background: transparent;
  color: rgba(255,255,255,.45);
  cursor: pointer;
  margin: 8px 8px 0 auto;
  transition: color .12s, background .12s, transform .12s;
  flex-shrink: 0;
}
.sidebarPinBtn:hover{
  background: rgba(255,255,255,.10);
  color: rgba(255,255,255,.80);
}
body.sidebarPinned .sidebarPinBtn{
  color: var(--vx-accent, rgba(255,255,255,.90));
  transform: rotate(45deg);
}

/* When pinned: sidebar is static, pushes content */
body:not(.inPlayer).sidebarPinned .view:not(.hidden) > .libraryShell{
  grid-template-columns: var(--lib-side-w, 280px) 1fr !important;
}
body:not(.inPlayer).sidebarPinned .view:not(.hidden) > .libraryShell > .libSidebar{
  position: static;
  transform: none !important;
  width: auto;
  box-shadow: none;
  transition: none;
}
/* Hide drawer backdrop when pinned */
body.sidebarPinned .drawerBackdrop{
  display: none;
}

/* ===== MERIDIAN_THEME: Color theme picker ===== */

.themeSwatches{
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  padding: 4px 0;
}
.themeSwatch{
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: 2px solid transparent;
  cursor: pointer;
  transition: border-color .15s, box-shadow .15s, transform .12s;
  position: relative;
  outline: none;
}
.themeSwatch:hover{
  transform: scale(1.12);
  box-shadow: 0 0 12px rgba(255,255,255,.15);
}
.themeSwatch.active{
  border-color: rgba(255,255,255,.85);
  box-shadow: 0 0 0 2px rgba(255,255,255,.25);
}
.themeSwatch::after{
  content: '';
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: rgba(255,255,255,.90);
  transform: translate(-50%, -50%);
}
.themeSwatch.active::after{
  display: block;
}

/* ===== MERIDIAN_KEYS: Global shortcut remapping ===== */

.globalShortcutsList{
  display: flex;
  flex-direction: column;
  gap: 2px;
}
.globalShortcutsList .br-shortcut-row{
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 5px 10px;
  font-size: 12px;
}
.globalShortcutsList .br-shortcut-label{
  color: rgba(255,255,255,.78);
}
.globalShortcutsList .br-shortcut-key-edit{
  min-width: 110px;
  text-align: center;
  border: 1px solid rgba(255,255,255,.12);
  border-radius: 6px;
  background: rgba(255,255,255,.04);
  color: rgba(255,255,255,.80);
  padding: 4px 8px;
  font-size: 11px;
  cursor: pointer;
  transition: background .12s, border-color .12s;
}
.globalShortcutsList .br-shortcut-key-edit:hover{
  background: rgba(255,255,255,.08);
  border-color: rgba(255,255,255,.22);
}
.globalShortcutsList .br-shortcut-key-edit.capturing{
  background: rgba(var(--vx-accent-rgb, 199,167,107), .18);
  border-color: var(--vx-accent, #c7a76b);
  color: var(--vx-accent, #c7a76b);
  animation: capturePulse .8s ease infinite alternate;
}
@keyframes capturePulse{
  from{ opacity: .7; }
  to{ opacity: 1; }
}