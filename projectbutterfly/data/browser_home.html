<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  background: transparent;
  font-family: 'Segoe UI', sans-serif;
  color: rgba(245,245,245,0.92);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  overflow: hidden;
  -webkit-user-select: none;
  user-select: none;
}

/* ---- Search pill ---- */
.search-bar {
  width: 540px;
  height: 44px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 22px;
  padding: 0 20px;
  font-size: 14px;
  font-family: 'Segoe UI', sans-serif;
  color: rgba(245,245,245,0.92);
  outline: none;
  transition: border-color 0.2s;
}
.search-bar::placeholder { color: rgba(245,245,245,0.35); }
.search-bar:focus { border-color: rgba(199,167,107,0.35); }

/* ---- Sources grid ---- */
.sources-row {
  display: flex;
  gap: 20px;
  margin-top: 36px;
  align-items: flex-start;
  justify-content: center;
  flex-wrap: wrap;
}

.source-tile {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 80px;
  padding: 8px 0;
  border-radius: 12px;
  cursor: pointer;
  background: transparent;
  border: none;
  transition: background 0.15s;
}
.source-tile:hover { background: rgba(255,255,255,0.06); }

.favicon-circle {
  width: 48px; height: 48px;
  border-radius: 50%;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  font-weight: 600;
  color: rgba(245,245,245,0.70);
}

.source-name {
  margin-top: 6px;
  font-size: 10px;
  color: rgba(245,245,245,0.60);
  text-align: center;
  max-width: 72px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Add tile */
.add-circle {
  width: 48px; height: 48px;
  border-radius: 50%;
  background: transparent;
  border: 2px dashed rgba(255,255,255,0.12);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  color: rgba(245,245,245,0.60);
}
</style>
</head>
<body>

<input class="search-bar" type="text" placeholder="Search Yandex or type a URL" autofocus>

<div class="sources-row" id="sourcesRow"></div>

<script>
// Sources are injected by Qt via runJavaScript before or after load
var _sources = [];

function renderSources(sources) {
  _sources = sources || [];
  var row = document.getElementById('sourcesRow');
  row.innerHTML = '';
  _sources.forEach(function(src) {
    var tile = document.createElement('div');
    tile.className = 'source-tile';
    tile.onclick = function() { _navigate(src.url); };
    var circle = document.createElement('div');
    circle.className = 'favicon-circle';
    circle.textContent = (src.name || '?')[0].toUpperCase();
    tile.appendChild(circle);
    var name = document.createElement('div');
    name.className = 'source-name';
    name.textContent = src.name || '';
    tile.appendChild(name);
    row.appendChild(tile);
  });
  // Add tile
  var addTile = document.createElement('div');
  addTile.className = 'source-tile';
  addTile.onclick = function() { _addSource(); };
  var addCircle = document.createElement('div');
  addCircle.className = 'add-circle';
  addCircle.textContent = '+';
  addTile.appendChild(addCircle);
  var addLabel = document.createElement('div');
  addLabel.className = 'source-name';
  addLabel.textContent = 'Add';
  addTile.appendChild(addLabel);
  row.appendChild(addTile);
}

// Communication with Qt â€” uses query params in navigation
function _navigate(url) {
  window.location.href = 'tankoweb://navigate?url=' + encodeURIComponent(url);
}

function _addSource() {
  window.location.href = 'tankoweb://add-source';
}

// Search bar
document.querySelector('.search-bar').addEventListener('keydown', function(e) {
  if (e.key === 'Enter') {
    var text = this.value.trim();
    if (text) {
      window.location.href = 'tankoweb://search?q=' + encodeURIComponent(text);
    }
  }
});
</script>
</body>
</html>
